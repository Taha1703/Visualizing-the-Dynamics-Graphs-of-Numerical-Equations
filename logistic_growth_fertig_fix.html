<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Logistische Gleichung – Simulation</title>

  <!-- JSXGraph -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jsxgraph/1.6.0/jsxgraphcore.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jsxgraph/1.6.0/jsxgraph.min.css" />

  <!-- MathJax -->
  <script>
    window.MathJax = {
      tex: { inlineMath: [['\\(', '\\)']] },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

  <style>
    body { font-family: "Segoe UI", sans-serif; background: #f9f9f9; margin: 0; padding: 2rem; display: flex; flex-direction: column; align-items: center; }
    h1 { font-size: 2rem; color: #264653; margin-bottom: 0.5rem; }
    .equation { font-size: 1.3rem; margin-bottom: 1rem; color: #444; }
    #graph { width: 800px; height: 500px; border: 1px solid #ccc; background: white; margin-bottom: 2rem; }
    .controls { display: flex; flex-direction: column; gap: 0.5rem; width: 90%; max-width: 600px; }
    .slider-container { display: flex; align-items: center; justify-content: space-between; gap: 1rem; }
    .slider-label { min-width: 60px; font-weight: 500; color: #555; }
    .slider { flex-grow: 1; }
    .value-label { width: 50px; text-align: right; font-family: monospace; color: #222; }
  </style>
</head>
<body>

  <h1>Simulation der logistischen Gleichung</h1>
  <div class="equation">
    \( x_{n+1} = r \cdot x_n \cdot \left(1 - \frac{x_n}{x_{\text{ges}}} \right) \)
  </div>

  <div id="graph"></div>

  <div class="controls">
    <div class="slider-container">
      <label class="slider-label">r:</label>
      <input id="rSlider" type="range" class="slider" min="1.0" max="4.0" step="0.01" value="2.0">
      <span id="rValue" class="value-label">2.00</span>
    </div>
    <div class="slider-container">
      <label class="slider-label">x₀:</label>
      <input id="x0Slider" type="range" class="slider" min="0" max="2" step="0.1" value="1.0">
      <span id="x0Value" class="value-label">1.0</span>
    </div>
    <div class="slider-container">
      <label class="slider-label">\(x_{\text{ges}}:\)</label>
      <input id="xmaxSlider" type="range" class="slider" min="0" max="2" step="0.1" value="1.0">
      <span id="xmaxValue" class="value-label">1.0</span>
    </div>
    <div class="slider-container">
      <label class="slider-label">n:</label>
      <input id="stepSlider" type="range" class="slider" min="10" max="50" step="1" value="30">
      <span id="stepValue" class="value-label">30</span>
    </div>
  </div>

  <script>
    
    const board = JXG.JSXGraph.initBoard("graph", {
      boundingbox: [-0.1, 2, 2, -0.1],
      showNavigation: false,
      showCopyright: false,
      axis: false
    });

    const xAxis = board.create('axis', [[0, 0], [1, 0]], {
      withLabel: false,
      ticks: { drawLabels: true, minorTicks: 0, ticksDistance: 5, label: { fontSize: 14 } }
    });

    const yAxis = board.create('axis', [[0, 0], [0, 1]], {
      withLabel: false,
      ticks: { drawLabels: true, minorTicks: 0, ticksDistance: 5, label: { fontSize: 14 } }
    });

    const sliders = {
      r: document.getElementById("rSlider"),
      x0: document.getElementById("x0Slider"),
      xmax: document.getElementById("xmaxSlider"),
      steps: document.getElementById("stepSlider"),
    };

    const labels = {
      r: document.getElementById("rValue"),
      x0: document.getElementById("x0Value"),
      xmax: document.getElementById("xmaxValue"),
      steps: document.getElementById("stepValue"),
    };

    let plotted = [];

    function updatePlot() {
      const r = parseFloat(sliders.r.value);
      const x0 = parseFloat(sliders.x0.value);
      const xmax = parseFloat(sliders.xmax.value);
      const steps = parseInt(sliders.steps.value);

      labels.r.textContent = r.toFixed(2);
      labels.x0.textContent = x0.toFixed(1);
      labels.xmax.textContent = xmax.toFixed(1);
      labels.steps.textContent = steps;

      let x = x0;
      const points = [[0, x]];
      for (let i = 1; i <= steps; i++) {
        x = r * x * (1 - x / xmax);
        points.push([i, x]);
      }

      plotted.forEach((obj) => board.removeObject(obj));
      plotted = [];

      
      const xs = points.map((_, i) => (i / steps) * 2);
      const ys = points.map(p => p[1]);

      xs.forEach((xVal, i) =>
        plotted.push(
          board.create("point", [xVal, ys[i]], {
            size: 2, name: "", color: "#264653", fixed: true, highlight: false,
          })
        )
      );

      const curve = board.create("curve", [xs, ys], {
        strokeWidth: 2, strokeColor: "#e76f51"
      });
      plotted.push(curve);

      
      const maxY = Math.max(...ys);
      const yPadding = (maxY) * 0.1 || 1;

      board.setBoundingBox([
        -0.1,              
        maxY + yPadding,   
        2,                 
        -0.1              
      ]);
    }

    Object.values(sliders).forEach(slider => {
      slider.addEventListener("input", updatePlot);
    });

    updatePlot();
  </script>
</body>
</html>
