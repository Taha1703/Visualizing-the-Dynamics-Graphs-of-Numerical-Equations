<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Sekante â€“ Interaktive Visualisierung</title>

  <!-- JSXGraph -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jsxgraph/1.6.0/jsxgraphcore.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jsxgraph/1.6.0/jsxgraph.min.css" />

  <!-- MathJax -->
  <script>
    window.MathJax = { tex: { inlineMath: [['\\(', '\\)']] }, svg: { fontCache: 'global' } };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

  <style>
    body { font-family: "Segoe UI", sans-serif; background: #f9f9f9; margin: 0; padding: 2rem;
           display: flex; flex-direction: column; align-items: center; }
    h1 { font-size: 2rem; color: #264653; margin-bottom: 0.5rem; }
    .equation { font-size: 1.1rem; margin-bottom: 1rem; color: #444; text-align: center; }
    #graph { width: 800px; height: 500px; border: 1px solid #ccc; background: white; margin-bottom: 1.5rem; }
    .controls { display: flex; flex-direction: column; gap: 0.5rem; width: 90%; max-width: 600px; }
    .slider-container { display: flex; align-items: center; justify-content: space-between; gap: 1rem; }
    .slider-label { min-width: 80px; font-weight: 500; color: #555; }
    .slider { flex-grow: 1; }
    .value-label { width: 60px; text-align: right; font-family: monospace; color: #222; }
  </style>
</head>
<body>

  <h1>Sekante</h1>
  <div class="equation">
    \( m(h)=\dfrac{f(x_0+h)-f(x_0)}{h},\;\;x_0=0{.}5,\;\; f(x)=e^x \)
  </div>

  <div id="graph"></div>

  <div class="controls">
    <div class="slider-container">
      <label class="slider-label">h:</label>
      <input id="hSlider" type="range" class="slider" min="0.001" max="2.5" step="0.001" value="1.000">
      <span id="hValue" class="value-label">1.000</span>
    </div>
  </div>

  <script>
    const board = JXG.JSXGraph.initBoard("graph", {
      boundingbox: [-1.0, 10, 3, -0.2],
      showNavigation: false,
      showCopyright: false,
      axis: false
    });

    const xAxis = board.create('axis', [[0, 0], [1, 0]], {
      withLabel: false,
      ticks: { drawLabels: true, minorTicks: 0, ticksDistance: 1, label: { fontSize: 14 } }
    });
    const yAxis = board.create('axis', [[0, 0], [0, 1]], {
      withLabel: false,
      ticks: { drawLabels: true, minorTicks: 0, ticksDistance: 1, label: { fontSize: 14, anchorX: 'right', offset: [-15, 0] } }
    });

    const hSlider = document.getElementById('hSlider');
    const hLabel  = document.getElementById('hValue');
    const x0 = 0.5;
    let objects = [];

    function makeFixedSegment(x1, y1, x2, y2, attrs) {
      const p1 = board.create('point', [x1, y1], { fixed: true, visible: false, name: '' });
      const p2 = board.create('point', [x2, y2], { fixed: true, visible: false, name: '' });
      const line = board.create('line', [p1, p2], Object.assign({
        straightFirst: false,
        straightLast: false,
        fixed: true,
        highlight: false
      }, attrs || {}));
      return { p1, p2, line };
    }

    function updatePlot() {
      const h = parseFloat(hSlider.value);
      hLabel.textContent = h.toFixed(3);

      objects.forEach(o => {
        if (o.line) { board.removeObject(o.line); board.removeObject(o.p1); board.removeObject(o.p2); }
        else { board.removeObject(o); }
      });
      objects = [];

      const xs = [], ys = [];
      for (let x = -2; x <= 3; x += 0.01) { xs.push(x); ys.push(Math.exp(x)); }
      const curve = board.create('curve', [xs, ys], { strokeWidth: 2, strokeColor: '#e76f51', highlight: false, fixed: true });
      objects.push(curve);

      const y0 = Math.exp(x0);
      const x1 = x0 + h;
      const y1 = Math.exp(x1);
      const m  = (y1 - y0) / h;
      const ySec = (x) => m * (x - x0) + y0;
      const ysSec = xs.map(x => ySec(x));
      const secCurve = board.create('curve', [xs, ysSec], { strokeWidth: 2, strokeColor: '#2a9d8f', dash: 2, highlight: false, fixed: true });
      objects.push(secCurve);

      const p0 = board.create('point', [x0, y0], { name: '', size: 4, color: '#264653', fixed: true, highlight: false });
      const p1pt = board.create('point', [x1, y1], { name: '', size: 4, color: '#264653', fixed: true, highlight: false });
      objects.push(p0, p1pt);

      const v0 = makeFixedSegment(x0, 0, x0, y0, { strokeColor: '#999', dash: 1 });
      const v1 = makeFixedSegment(x1, 0, x1, y1, { strokeColor: '#999', dash: 1 });
      objects.push(v0, v1);

      board.setBoundingBox([-0.5, 20, 3, -1]);
    }

    hSlider.addEventListener('input', updatePlot);
    updatePlot();
  </script>
</body>
</html>
